<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Income Bot - Home</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    <script src="ad_network_script.js"></script> 
    <style>
        body { font-family: Arial, sans-serif; background-color: #f0f2f5; margin: 0; padding: 0; }
        .header-image { width: 100%; height: auto; display: block; }
        .main-container { padding: 15px; max-width: 600px; margin: 0 auto; }
        .nav-buttons { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        .nav-buttons button { background-color: #ffffff; color: #1e3a8a; padding: 20px; font-size: 1.1em; font-weight: bold; border: 1px solid #ddd; border-radius: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); transition: background-color 0.3s; }
        .nav-buttons button:hover { background-color: #e0f2fe; }
        .nav-buttons span { display: block; font-size: 1.8em; margin-bottom: 5px; }
        
        /* Modal Styles */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5); }
        .modal-content { background-color: #fefefe; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 500px; border-radius: 10px; }
        .close-button { color: #aaa; float: right; font-size: 28px; font-weight: bold; }
        .close-button:hover, .close-button:focus { color: black; text-decoration: none; cursor: pointer; }
        
        /* Account Info Styling */
        .account-info { text-align: left; padding: 15px; border: 1px solid #ccc; border-radius: 8px; margin-bottom: 20px; background-color: #fff; }
        .account-info p { margin: 8px 0; font-size: 1em; }
        .account-info strong { color: #1e3a8a; }
        
        /* Balance Styling */
        .balance-box { background-color: #10b981; color: white; padding: 20px; border-radius: 10px; text-align: center; margin-bottom: 20px; }
        .balance-box h2 { margin: 0 0 5px 0; font-size: 1.2em; }
        .balance-box p { font-size: 2.5em; font-weight: bold; margin: 0; }
        .bdt-conversion { font-size: 1.1em; opacity: 0.8; margin-top: 5px; }
        
        /* Earn Page Styling */
        .ad-button { background-color: #f59e0b; color: white; padding: 15px; margin-bottom: 10px; border: none; border-radius: 6px; width: 100%; font-size: 1.1em; cursor: pointer; }
        .ad-button:hover { background-color: #d97706; }
        .ad-status { color: green; font-weight: bold; margin-bottom: 10px; }

        /* Referral Page Styling */
        .referral-box { background-color: #fff; padding: 15px; border-radius: 8px; border: 1px solid #ccc; margin-bottom: 20px; text-align: center; }
        .referral-box h3 { color: #1e3a8a; margin-top: 0; }
        .bonus-highlight { background-color: #ffe0b2; padding: 10px; border-radius: 6px; font-size: 1.2em; font-weight: bold; margin: 15px 0; border: 2px dashed #ff9800; }
        .referral-link-display { background-color: #e0f2fe; padding: 10px; border-radius: 4px; overflow-wrap: break-word; }
        .leaderboard { margin-top: 20px; text-align: left; }
        .leaderboard h4 { border-bottom: 2px solid #ddd; padding-bottom: 5px; }
        .leaderboard ol { padding-left: 20px; }

        /* Withdraw Page Styling */
        .withdraw-form input, .withdraw-form select { width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        .withdraw-form button { background-color: #007bff; color: white; padding: 12px; border: none; border-radius: 4px; cursor: pointer; width: 100%; }
        .withdraw-history-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .withdraw-history-table th, .withdraw-history-table td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        .withdraw-history-table th { background-color: #f2f2f2; }
        .status-pending { color: orange; font-weight: bold; }
        .status-completed { color: green; font-weight: bold; }
        
    </style>
</head>
<body>
    <img src="https://i.ibb.co.com/F4vhpsrS/1764231708480.png" alt="Welcome Banner" class="header-image">

    <div class="main-container">
        <div class="nav-buttons">
            <button onclick="openModal('myAccountModal')"><span>üí†</span> My Account</button>
            <button onclick="openModal('balanceModal')"><span>üí∞</span> Balance</button>
            <button onclick="openModal('earnModal')"><span>üíµ</span> Earn</button>
            <button onclick="openModal('referralModal')"><span>üë§</span> Referral</button>
            <button onclick="openModal('withdrawModal')"><span>üèß</span> Withdraw</button>
            <button onclick="openSupport()"><span>üìû</span> Support</button>
        </div>
    </div>

    <div id="myAccountModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('myAccountModal')">&times;</span>
            <h2>üí† My Account</h2>
            <div class="account-info">
                <p><strong>User Name:</strong> <span id="account-username">Loading...</span></p>
                <p><strong>ID No:</strong> <span id="account-idno">Loading...</span></p>
                <p><strong>Total Referral:</strong> <span id="account-total-referral">0</span></p>
                <p><strong>Balance:</strong> <span id="account-balance">0.01 USDT</span></p>
                <p><strong>Wallet Set:</strong> <span id="account-wallet">Not Set</span></p>
            </div>
            <h3>‚öôÔ∏è ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§</h3>
            <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶ï‡¶≤ ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶®‡¶ø‡¶ö‡ßá ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡¶≤‡ßã:</p>
            <ul>
                <li>‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡¶≤‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ‡¶™‡¶æ‡¶¨‡ßá‡¶® **0.001 USDT**‡•§</li>
                <li>‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶∏‡¶´‡¶≤ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ‡¶™‡¶æ‡¶¨‡ßá‡¶® **0.01 USDT**‡•§</li>
                <li>‡¶¶‡ßà‡¶®‡¶ø‡¶ï ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö **200‡¶ü‡¶ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°** ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§</li>
            </ul>
        </div>
    </div>

    <div id="balanceModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('balanceModal')">&times;</span>
            <h2>üí∞ My Balance</h2>
            <div class="balance-box">
                <h2>‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ (USDT)</h2>
                <p id="current-usdt-balance">0.01 USDT</p>
                <div class="bdt-conversion">
                    (~ <span id="current-bdt-balance">1.10 BDT</span>)
                    <small>* $1 = 110 BDT (Estimated)</small>
                </div>
            </div>
            <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶ï‡¶≤ ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶æ‡¶™‡ßç‡¶§ USDT ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶ú‡¶Æ‡¶æ ‡¶π‡¶¨‡ßá ‡¶è‡¶¨‡¶Ç ‡¶°‡¶≤‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∞‡ßá‡¶ü ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ BDT ‡¶§‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá‡•§</p>
        </div>
    </div>
    
    <div id="earnModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('earnModal')">&times;</span>
            <h2>üíµ Earn: Watch Ads (‡¶¶‡ßà‡¶®‡¶ø‡¶ï ‡ß®‡ß¶‡ß¶‡¶ü‡¶ø)</h2>
            <p class="ad-status">‡¶Ü‡¶ú‡¶ï‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°: <span id="ads-watched-count">0</span> / 200</p>
            <p>‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°: **0.001 $**‡•§ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶∂‡ßá‡¶∑ ‡¶®‡¶æ ‡¶ï‡¶∞‡ßá ‡¶¨‡ßá‡¶∞ ‡¶π‡¶≤‡ßá ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶™‡¶æ‡¶¨‡ßá‡¶® ‡¶®‡¶æ‡•§</p>
            
            <button class="ad-button" onclick="watchAd(1)">Watch Ad 1 (‡ß´‡ß¶‡¶ü‡¶ø)</button>
            <button class="ad-button" onclick="watchAd(2)">Watch Ad 2 (‡ß´‡ß¶‡¶ü‡¶ø)</button>
            <button class="ad-button" onclick="watchAd(3)">Watch Ad 3 (‡ß´‡ß¶‡¶ü‡¶ø)</button>
            <button class="ad-button" onclick="watchAd(4)">Watch Ad 4 (‡ß´‡ß¶‡¶ü‡¶ø)</button>

            <div id="ad-container" style="display:none;"></div>
            <button id="ad-verify-button" class="ad-button" style="display:none; background-color:#1e3a8a;" onclick="verifyAdCompletion()">Ad Verify</button>
        </div>
    </div>

    <div id="referralModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('referralModal')">&times;</span>
            <h2>üë§ Referral</h2>
            <div class="referral-box">
                <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï‡¶ü‡¶ø ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶Ü‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ ‡¶∏‡¶æ‡¶á‡¶® ‡¶Ü‡¶™ ‡¶ï‡¶∞‡¶≤‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶™‡¶æ‡¶¨‡ßá‡¶®‡•§</p>
                <div class="bonus-highlight">
                    üéÅ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá **0.01 $** ‡¶¨‡ßã‡¶®‡¶æ‡¶∏
                </div>
                <h3>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶≤‡¶ø‡¶Ç‡¶ï</h3>
                <div class="referral-link-display" id="referral-link">
                    https://t.me/OnlineIncomeBot?start=user_id_12345
                </div>
                <p><strong>Total Refer:</strong> <span id="total-refer-count">0</span> ‡¶ú‡¶®</p>
            </div>

            <div class="leaderboard">
                <h4>Top 10 Referrers</h4>
                <ol id="top-referrers-list">
                    <li>UserA - 50 Referrals</li>
                    <li>UserB - 45 Referrals</li>
                    </ol>
            </div>
        </div>
    </div>

    <div id="withdrawModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('withdrawModal')">&times;</span>
            <h2>üèß Withdraw</h2>
            
            <h3>Wallet Set</h3>
            <div class="withdraw-form">
                <select id="wallet-method">
                    <option value="">‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶Æ‡ßá‡¶•‡¶° ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</option>
                    <option value="USDT">USDT BEP-20</option>
                    <option value="Bkash">Bkash</option>
                    <option value="Nagad">Nagad</option>
                </select>
                <input type="text" id="wallet-address" placeholder="Wallet Address / Phone Number" />
                <button onclick="setWallet()">Set Wallet</button>
                <p id="wallet-status-msg" style="color:green;"></p>
            </div>

            <h3 style="margin-top:20px;">Withdraw Amount</h3>
            <p>Minimum Withdraw: **0.2 USDT** / **20 BDT**</p>
            <div class="withdraw-form">
                <input type="number" id="withdraw-amount" placeholder="Amount (USDT / BDT)" />
                <button onclick="processWithdraw()">Withdraw</button>
                <p id="withdraw-status-msg" style="color:red;"></p>
            </div>

            <h3 style="margin-top:20px;">Withdraw History</h3>
            <table class="withdraw-history-table">
                <thead>
                    <tr>
                        <th>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</th>
                        <th>‡¶á‡¶â‡¶ú‡¶æ‡¶∞</th>
                        <th>‡¶ì‡ßü‡¶æ‡¶≤‡ßá‡¶ü</th>
                        <th>‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</th>
                        <th>‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏</th>
                    </tr>
                </thead>
                <tbody id="withdraw-history-body">
                    <tr>
                        <td>25/11/2025</td>
                        <td>User Name</td>
                        <td>Bkash</td>
                        <td>20 BDT</td>
                        <td class="status-completed">Completed</td>
                    </tr>
                    <tr>
                        <td>26/11/2025</td>
                        <td>User Name</td>
                        <td>USDT</td>
                        <td>0.5 USDT</td>
                        <td class="status-pending">Pending</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Firebase Configuration (Same as index.html)
        const firebaseConfig = {
            apiKey: "AIzaSyAHc2wCCZXSkobP3_BiiImU4PCdJGSoXOY",
            authDomain: "mythic-code-471708-v5.firebaseapp.com",
            databaseURL: "https://mythic-code-471708-v5-default-rtdb.firebaseio.com",
            projectId: "mythic-code-471708-v5",
            storageBucket: "mythic-code-471708-v5.firebasestorage.app",
            messagingSenderId: "664163784430",
            appId: "1:664163784430:web:b3a2039a471e0706c805ff",
            measurementId: "G-RR9K6QQMRZ"
        };
        const app = firebase.initializeApp(firebaseConfig);
        const database = app.database();

        // Global variables (should be loaded from Firebase for the actual user)
        let currentUser = {
            id: '12345', // Placeholder: Get this from Telegram Web App init data
            username: 'DemoUser',
            balanceUSDT: 0.01,
            referralCount: 0,
            wallet: { method: 'None', address: '' },
            adsToday: 0
        };
        const USDT_TO_BDT_RATE = 110;
        const AD_REWARD = 0.001;
        const REFERRAL_BONUS = 0.01;

        // --- Core UI Functions ---
        function openModal(id) {
            document.getElementById(id).style.display = 'block';
            if (id === 'myAccountModal') loadAccountData();
            if (id === 'balanceModal') loadBalanceData();
            if (id === 'referralModal') loadReferralData();
        }

        function closeModal(id) {
            document.getElementById(id).style.display = 'none';
        }

        function openSupport() {
            window.open('https://t.me/Help_Line_Online', '_blank');
        }

        // --- Data Loading Functions ---
        function loadAccountData() {
            document.getElementById('account-username').innerText = currentUser.username;
            document.getElementById('account-idno').innerText = currentUser.id;
            document.getElementById('account-total-referral').innerText = currentUser.referralCount;
            document.getElementById('account-balance').innerText = `${currentUser.balanceUSDT.toFixed(2)} USDT`;
            document.getElementById('account-wallet').innerText = currentUser.wallet.method === 'None' ? 'Not Set' : `${currentUser.wallet.method} (${currentUser.wallet.address})`;
        }

        function loadBalanceData() {
            const bdtBalance = currentUser.balanceUSDT * USDT_TO_BDT_RATE;
            document.getElementById('current-usdt-balance').innerText = `${currentUser.balanceUSDT.toFixed(3)} USDT`;
            document.getElementById('current-bdt-balance').innerText = `${bdtBalance.toFixed(2)} BDT`;
        }

        function loadReferralData() {
            document.getElementById('total-refer-count').innerText = currentUser.referralCount;
            // In a real app, load top referrers from a Firebase snapshot and dynamically populate the list.
        }

        // --- Earn Logic ---
        function watchAd(adSet) {
            if (currentUser.adsToday >= 200) {
                alert('‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶∏‡ßÄ‡¶Æ‡¶æ (‡ß®‡ß¶‡ß¶‡¶ü‡¶ø) ‡¶Ö‡¶§‡¶ø‡¶ï‡ßç‡¶∞‡¶Æ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§');
                return;
            }

            // Show Ad Button (or load ad script here)
            alert(`Showing Ad from Set ${adSet}. Please wait for the Rewarded Interstitial to load...`);

            // --- Ad Network Integration (The code you provided) ---
            // Assuming `show_10242818()` is a function provided by the external ad_network_script.js
            try {
                // Call the actual ad show function
                show_10242818().then(() => {
                    // This function is executed after the user watches the ad.
                    alert('You have seen an ad! Click Verify to confirm.');
                    document.getElementById('ad-verify-button').style.display = 'block';
                }).catch(error => {
                    console.error("Ad failed to load or close:", error);
                    alert('Ad failed to load. Please try again.');
                });
            } catch (e) {
                console.error("Ad Network script function not found:", e);
                alert("Ad Network script not properly loaded. Simulating ad watch...");
                // Simulating immediate success for demo purposes
                document.getElementById('ad-verify-button').style.display = 'block';
            }
        }

        function verifyAdCompletion() {
            // **IMPORTANT:** The *real* verification must be done on the server/backend side to prevent cheating.
            // The ad network usually sends a Server-Side Callback (SSV) upon successful completion.

            // Simulate server-side verification and reward
            if (currentUser.adsToday < 200) {
                currentUser.adsToday++;
                currentUser.balanceUSDT += AD_REWARD;
                // Update Firebase: user's balance and adsToday count
                // database.ref('users/' + currentUser.id).update({
                //     balance: currentUser.balanceUSDT,
                //     adsToday: currentUser.adsToday
                // });
                
                document.getElementById('ads-watched-count').innerText = currentUser.adsToday;
                document.getElementById('ad-verify-button').style.display = 'none';
                alert(`‚úÖ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶≠‡ßá‡¶∞‡¶ø‡¶´‡¶æ‡¶á ‡¶π‡ßü‡ßá‡¶õ‡ßá! ‡¶Ü‡¶™‡¶®‡¶ø ${AD_REWARD} USDT ‡¶™‡ßá‡ßü‡ßá‡¶õ‡ßá‡¶®‡•§`);
                loadBalanceData(); // Update balance display
            } else {
                alert('‡¶¶‡ßà‡¶®‡¶ø‡¶ï ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶∏‡ßÄ‡¶Æ‡¶æ ‡¶Ö‡¶§‡¶ø‡¶ï‡ßç‡¶∞‡¶Æ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§');
                document.getElementById('ad-verify-button').style.display = 'none';
            }
        }

        // --- Withdraw Logic ---
        function setWallet() {
            const method = document.getElementById('wallet-method').value;
            const address = document.getElementById('wallet-address').value.trim();

            if (!method || !address) {
                alert('‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶Æ‡ßá‡¶•‡¶° ‡¶è‡¶¨‡¶Ç Address/Number ‡¶¶‡¶ø‡¶®‡•§');
                return;
            }

            currentUser.wallet = { method, address };
            // Update Firebase
            // database.ref('users/' + currentUser.id + '/wallet').set(currentUser.wallet);

            document.getElementById('wallet-status-msg').innerText = `Wallet Set Success! (${method}: ${address})`;
            setTimeout(() => document.getElementById('wallet-status-msg').innerText = '', 3000);
        }

        function processWithdraw() {
            const amountInput = parseFloat(document.getElementById('withdraw-amount').value);
            const minUSDT = 0.2;
            const minBDT = 20;

            if (!currentUser.wallet.method || currentUser.wallet.method === 'None') {
                document.getElementById('withdraw-status-msg').innerText = '‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá Wallet Set ‡¶ï‡¶∞‡ßÅ‡¶®‡•§';
                return;
            }

            if (isNaN(amountInput) || amountInput <= 0) {
                document.getElementById('withdraw-status-msg').innerText = '‡¶∏‡¶†‡¶ø‡¶ï ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶¶‡¶ø‡¶®‡•§';
                return;
            }

            let withdrawUSDT = 0;
            if (currentUser.wallet.method === 'USDT') {
                withdrawUSDT = amountInput;
            } else { // Bkash/Nagad (assuming BDT input)
                withdrawUSDT = amountInput / USDT_TO_BDT_RATE;
            }

            if (withdrawUSDT < minUSDT) {
                 document.getElementById('withdraw-status-msg').innerText = `‡¶∏‡¶∞‡ßç‡¶¨‡¶®‡¶ø‡¶Æ‡ßç‡¶® ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ${minUSDT} USDT / ${minBDT} BDT‡•§`;
                return;
            }

            if (withdrawUSDT > currentUser.balanceUSDT) {
                document.getElementById('withdraw-status-msg').innerText = '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶§ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶®‡ßá‡¶á‡•§';
                return;
            }

            // --- Server-side Logic Placeholder ---
            // The real withdrawal MUST be processed on a secure server.
            currentUser.balanceUSDT -= withdrawUSDT;
            
            // Log transaction to Firebase (Withdrawals node)
            const transactionRef = database.ref('withdrawals').push();
            const withdrawData = {
                date: new Date().toLocaleDateString('bn-BD'),
                username: currentUser.username,
                wallet: currentUser.wallet.method,
                amountUSDT: withdrawUSDT.toFixed(3),
                amountLocal: amountInput.toFixed(2),
                status: 'pending' // Initial status
            };
            // transactionRef.set(withdrawData); 

            // Add to History (UI Update)
            const historyBody = document.getElementById('withdraw-history-body');
            const newRow = historyBody.insertRow(0);
            newRow.innerHTML = `
                <td>${withdrawData.date}</td>
                <td>${withdrawData.username}</td>
                <td>${withdrawData.wallet}</td>
                <td>${withdrawData.amountLocal} ${currentUser.wallet.method === 'USDT' ? 'USDT' : 'BDT'}</td>
                <td class="status-pending">Pending</td>
            `;

            document.getElementById('withdraw-status-msg').style.color = 'green';
            document.getElementById('withdraw-status-msg').innerText = `‚úÖ ${amountInput} ${currentUser.wallet.method} ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®‡ßá‡¶∞ ‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶∏‡¶´‡¶≤! (Pending)`;
            
            // Clear input
            document.getElementById('withdraw-amount').value = '';
            loadBalanceData(); // Update balance display
            
            setTimeout(() => document.getElementById('withdraw-status-msg').innerText = '', 5000);
        }

        // Initialize on load
        window.onload = function() {
            // Check if user is authenticated/has an ID (Placeholder for real auth check)
            loadAccountData(); 
            loadBalanceData();
            // Optional: You would usually load all user data from Firebase here.
        };
        
        // Ensure the external ad network script exists for the functions to work
        if (typeof show_10242818 !== 'function') {
            console.warn("AD network function 'show_10242818' not found. Please ensure 'ad_network_script.js' is correctly linked and loaded.");
            // Define a placeholder to prevent errors in the demo
            window.show_10242818 = () => {
                return new Promise(resolve => {
                    setTimeout(() => resolve(), 3000); // Simulate 3s ad watch
                });
            };
        }

    </script>
</body>
</html>